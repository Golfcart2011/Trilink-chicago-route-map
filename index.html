<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Airline Route Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
  body { margin:0; padding:0; }
  #map { width:100%; height:100vh; }

  .legend {
    background:white;
    padding:10px 12px;
    font-family:Arial, sans-serif;
    font-size:13px;
    border-radius:6px;
    box-shadow:0 0 6px rgba(0,0,0,0.25);
  }
  .legend i {
    width:18px;
    height:3px;
    float:left;
    margin-right:8px;
    margin-top:7px;
  }
</style>
</head>

<body>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>

/* =========================
   MAP
   ========================= */
const map = L.map("map").setView([45,5], 2);

L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
  attribution: "&copy; OpenStreetMap contributors"
}).addTo(map);

/* =========================
   AIRPORT DATABASE
   ========================= */
const airports = {
  KORD:{name:"Chicago O'Hare (KORD)",coords:[41.9742,-87.9073],trilink:true,lyon:false},
  LYS:{name:"Lyon Saint-ExupÃ©ry (LYS)",coords:[45.7256,5.0811],trilink:true,lyon:true},

  AMS:{name:"Amsterdam (AMS)",coords:[52.3105,4.7683],trilink:true},
  ATH:{name:"Athens (ATH)",coords:[37.9364,23.9445],trilink:true,lyon:true},
  BCN:{name:"Barcelona (BCN)",coords:[41.2974,2.0833],trilink:true},
  BEG:{name:"Belgrade (BEG)",coords:[44.8184,20.3091],trilink:true},
  BRU:{name:"Brussels (BRU)",coords:[50.9010,4.4844],trilink:true},
  CPH:{name:"Copenhagen (CPH)",coords:[55.6181,12.6561],trilink:true},
  DUB:{name:"Dublin (DUB)",coords:[53.4264,-6.2499],trilink:true},
  FRA:{name:"Frankfurt (FRA)",coords:[50.0379,8.5622],trilink:true},
  IST:{name:"Istanbul (IST)",coords:[41.2753,28.7519],trilink:true},
  LHR:{name:"London Heathrow (LHR)",coords:[51.47,-0.4543],trilink:true},
  MAD:{name:"Madrid (MAD)",coords:[40.472,-3.561],trilink:true},
  MUC:{name:"Munich (MUC)",coords:[48.3538,11.7861],trilink:true},
  CDG:{name:"Paris CDG (CDG)",coords:[49.0097,2.5479],trilink:true},
  ZRH:{name:"Zurich (ZRH)",coords:[47.4581,8.5555],trilink:true},

  BOD:{name:"Bordeaux (BOD)",coords:[44.8283,-0.7156],lyon:true},
  LIG:{name:"Limoges (LIG)",coords:[45.8628,1.1794],lyon:true},
  NTE:{name:"Nantes (NTE)",coords:[47.1532,-1.6107],lyon:true},
  DKR:{name:"Dakar (DKR)",coords:[14.7397,-17.4902],lyon:true},
  SAW:{name:"Istanbul Sabiha (SAW)",coords:[40.8986,29.3092],lyon:true},
  LIS:{name:"Lisbon (LIS)",coords:[38.7742,-9.1342],lyon:true},
  LGW:{name:"London Gatwick (LGW)",coords:[51.1537,-0.1821],lyon:true},
  RAK:{name:"Marrakesh (RAK)",coords:[31.6069,-8.0363],lyon:true},
  MXP:{name:"Milan Malpensa (MXP)",coords:[45.6306,8.7281],lyon:true},
  ORN:{name:"Oran (ORN)",coords:[35.6239,-0.6212],lyon:true},
  PRG:{name:"Prague (PRG)",coords:[50.1008,14.2632],lyon:true},
  TRN:{name:"Turin (TRN)",coords:[45.2008,7.6496],lyon:true},
  LCY:{name:"London City (LCY)",coords:[51.5053,0.0553],lyon:true}
};

/* =========================
   ROUTE LAYERS
   ========================= */
const trilinkRoutes = L.layerGroup();
const lyonRoutes = L.layerGroup();

const trilinkColor = "#b22234";
const lyonColor = "#ff7f00";

Object.keys(airports).forEach(code=>{
  if(airports[code].trilink && code!=="KORD")
    L.polyline([airports.KORD.coords,airports[code].coords],
      {color:trilinkColor,weight:2.5,opacity:0.8}).addTo(trilinkRoutes);

  if(airports[code].lyon && code!=="LYS")
    L.polyline([airports.LYS.coords,airports[code].coords],
      {color:lyonColor,weight:2.5,opacity:0.8}).addTo(lyonRoutes);
});

trilinkRoutes.addTo(map);
lyonRoutes.addTo(map);

/* =========================
   AIRPORT MARKERS (DYNAMIC)
   ========================= */
const airportMarkers = {};

Object.keys(airports).forEach(code=>{
  airportMarkers[code] = L.marker(airports[code].coords)
    .bindPopup(`<b>${airports[code].name}</b>`);
});

/* =========================
   MARKER VISIBILITY LOGIC
   ========================= */
function updateAirports(){
  Object.keys(airports).forEach(code=>{
    const a = airports[code];
    const show =
      (a.trilink && map.hasLayer(trilinkRoutes)) ||
      (a.lyon && map.hasLayer(lyonRoutes));

    if(show && !map.hasLayer(airportMarkers[code]))
      airportMarkers[code].addTo(map);
    if(!show && map.hasLayer(airportMarkers[code]))
      map.removeLayer(airportMarkers[code]);
  });
}

updateAirports();

/* =========================
   FILTER CONTROL
   ========================= */
L.control.layers(null,{
  "Trilink Routes":trilinkRoutes,
  "Lyon Air":lyonRoutes
},{collapsed:false}).addTo(map);

map.on("overlayadd overlayremove",updateAirports);

/* =========================
   LEGEND
   ========================= */
const legend = L.control({position:"bottomright"});
legend.onAdd = ()=>{
  const d = L.DomUtil.create("div","legend");
  d.innerHTML=`
    <strong>Route Legend</strong><br>
    <i style="background:${trilinkColor}"></i> Trilink Routes<br>
    <i style="background:${lyonColor}"></i> Lyon Air`;
  return d;
};
legend.addTo(map);

</script>
</body>
</html>
